---
title: HCNA 配置之 ACL 和 NAT
date: 2019-09-12 07:58
updated: 2019-09-12 07:58
cover: //cdn.wallleap.cn/img/pic/cover/202302ElvaUD.jpg
category: 技术杂谈
tags:
  - 网络
  - HCNA
description: HCNA 配置之 ACL 和 NAT
---

我本来只是想写下HCNA的内容的，可是发现还是得讲下**计算机网络基础**

今天就**先讲下两种网络参考模型吧**

## No.0 引言

在计算机网络刚出现的时候，也就是两个主机使用一根网线相连，发展到后面，在一个计算机网络中，使用各自开发的技术，终端之间进行数据通信和资源共享。但是随着网络的扩张，需要有一个统一的协议(规则)，来实现不同网络之间的互联。

国际标准化组织 ISO 制定了网络互连的七层框架的一个参考模型，称为**开放系统互连参考模型**，简称 **OSI/RM**(Open System Internetwork Reference Model)。

由于 OSI 模型和协议比较复杂，所以并没有得到广泛的应用。于是20世纪70年代中期美国国防部为 ARPANET 开发了 **TCP/IP** 网络体系结构, TCP/IP 是一组用于实现网络互连的通信协议。Internet 网络体系结构以 TCP/IP 为核心，基于 TCP/IP 的参考模型将协议分成**四个层次和5个层次**。而 TCP/IP 模型因其开放性和易用性在实践中得到了广泛的应用，**TCP/IP 协议栈**也成为互联网的主流协议。

> 注：OSI/RM 法律上标准，TCP/IP 工业网络体系标准。

![img](https://mmbiz.qpic.cn/mmbiz_jpg/bQicJnZn4LHTuxKwib3AibzSz7x7m55ia3yJkkayrgwLJj5teMia6LvgQCTSaVvwwc7u32vvy2qA4NN5y2cTSBtAsrg/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

而我们主要使用的是介于4层和7层之间的 TCP/IP 5层模型，由高至底为**应用层**、**传输层**、**网络层**、**数据链路层**和**物理层**。

## No.1 功能

不同主机之间的相同层次被称为**对等层(Peer)**。

对等层之间存在协议关系。即对等实体之间互相通信需要遵守一定的规则，如通信的内容、通信的方式等。这种对等实体之间交换数据或通信时必须遵守的规则称为**对等层协议(Peer Protocol)**。

**网络协议的三要素**：

* <1> 语法：数据与控制信息的结构或格式
* <2> 语义：需要发出何种控制信息，完成何种动作以及做出何种响应。
* <3> 同步：事情实现顺序的详细说明

除了物理层外，OSI 模型中的其他6个对等层都存在对应的协议，如数据链路层协议、网络层协议等，对等实体利用对等协议进行通信以向高层提供**服务**。

实际上，对等层之间的通信是虚拟通信，它们之间的通信是使用下一层提供的服务来实现的。同一网络中不同主机的对等层，要安装运行相同的网络协议，主机间才能进行有效通信。这可以概括为“协议是水平的”。

在 OSI 分层结构模型中，每一层实体为相邻的上一层实体提供的通信功能称为**服务**。

**服务类型**：

* <1> 面向连接服务：两个N层实体在数据交换前，必须先建立连接，即首先初始化状态信息。并且为N+1层实体的信息传输建立一个通道。在数据传输阶段，通过这些状态信息，第N层实体可以跟踪在它们之间的PDU交换及它们与更高层的SDU交换。当数据交换结束后应释放这个连接，即去除状态信息，释放建立连接时所分配的资源。
* <2> 无连接服务：两个N层实体通信前，不需要先建立一个连接，即不需要事先进行预定保留状态信息。同一个用户到相同目的地的信息块都独立发送，接收端无需返回确认信息。如果信息在传输中丢失，就不再重发。不可靠的无连接的服务通常被称为数据报服务。

**服务原语**：

服务是通过一组服务原语(Primitive)来描述的，这些原语供用户和其他实体访问服务，通知服务提供者采取某些行动或报告某个对等实体的活动。

* <1> 请求(Request)：由服务用户发往服务提供者，请求它完成某项工作。
* <2> 指示(Indication)：由服务提供者发往服务用户，指示发生了某些事件。
* <3> 响应(Response)：由服务用户发往服务提供者，对前面发生的指示的响应。
* <4> 证实(Confirmation)：由服务提供者发往服务用户，对前面发生的请求的证实。

N 层实体利用 N-1 层实体所提供的服务，向 N+I 层实体提供功能更强大的服务。这可以概括为“**服务是垂直的**”。

例如，传输层实体利用网络层实体的服务，向应用层实体提供网页传输服务。

N 层实体使用 N-1 层实体所提供的服务时，不需要知道 N-1 层实体所提供的服务是如何实现的以及 N-1 层实体间的协议，而只需要知道下一层可以为自己提供哪些服务(是快速昂贵通信还是慢速低廉通信)，以及通过什么样的**接口**提供的。

在 OSI 模型中，各层之间的接口都有统一的规则。N 层的服务访问点 SAP(Service Access Point) 是 N 层实体提供服务给 N+1 层的地方，SAP 可以理解为下层实体之间的逻辑传输通道。每一层的 SAP 都有一个唯一标明它的地址。一个 N 层可能存在多个 SAP。

* PDU：协议数据单元 对等实体之间传送的数据单位
* SDU：服务数据单元 层与层之间交换的数据的单位
* IDU：接口数据单元 在同一系统上下两层实体的交换信息中，经过SAP的信息单元

可以是多个SDU合成一个PDU,也可以是一个SDU划分为几个PDU。

![img](https://mmbiz.qpic.cn/mmbiz_jpg/bQicJnZn4LHTuxKwib3AibzSz7x7m55ia3yJllYIZd4HepVkvQfvbq8vfuiaX9nONm9ugvBlCKwgYX9Vu9cMr67vCvQ/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

**各层功能**：

（1）物理层

**物理层**（Physical Layer）是 OSI 参考模型的最低层。

物理层的主要任务就是**透明地传送二进制比特流**，即经过实际电路传送后的比特流没有发生变化。但是物理层并不关心比特流的实际意义和结构，只是负责接收和传送比特流。作为发送方，物理层通过传输介质发送数据；作为接收方，物理层通过传输介质接收数据。物理层的另一个任务就是定义**网络硬件**的特性，包括使用什么样的**传输介质**以及与传输介质连接的**接头**等物理特性。

物理层定义的典型规范代表有 EIA/TIA RS-232、EIA/TIA RS-449、V.35、RJ-45 等。

值得注意的是，传送信息利用的**物理传输介质**，如双绞线、同轴电缆、光纤等，并不在物理层之内，而是**在物理层之下**。

（2）数据链路层

**数据链路层**（Data Link Layer）是 OSI 参考模型的第2层。

数据链路层的主要任务是在两个相邻节点间的线路上**无差错地传送以帧（Frame）为单位的数据**，使数据链路层对网络层显现为一条无差错线路。由于物理层仅仅接收和传送比特流，并不关心比特流的意义和结构，所以数据链路层要产生和识别帧边界。另外，数据链路层还提供了差错控制与流量控制的方法，保证在物理线路上传送的数据无差错。广播式网络在数据链路层还要处理新的问题，即如何控制各个节点对共享信道的访问。

数据链路层协议的代表有 SDLC、HDLC、PPP、STP、帧中继等。

（3）网络层

**网络层**（Network Layer）是 OSI 参考模型的第3层。

在这一层，数据的单位为**数据分组**（Packet）（数据包）。网络层的关键问题是如何进行**路由选择**，以确定数据分组如何从发送端到达接收端。如果在子网中同时出现的数据分组太多，将会互相阻塞，影响数据的正常传输。因此，拥塞控制也是网络层的功能之一。

另外，当数据分组需要经过另一个网络以到达目的地时，第二个网络的寻址方法、分组长度、网络协议可能与第一个网络不同，因此，网络层还要解决异构网络的互连问题。

网络层协议的代表有 IP、IPX、RIP、OSPF 等。

（4）传输层

**传输层**（Transport Layer）是 OSI 参考模型的第4层。

传输层从会话层接收数据，形成**报文**（Message），并且在必要时将其分成若干个分组，然后交给网络层进行传输。

传输层的主要功能是：为上一层进行通信的两个之间提供一个可靠的端到端服务，使传输层以上的各层看不见传输层以下的细节，传输层以上的各层不再关心信息传输的问题。端到端是指进行相互通信的两个节点不是直接通过传输介质连接起来的，相互之间有很多交换设备。这样的两个节点之间的通信就称为端到端通信。

传输层协议的代表有 TCP、UDP、SPX 等。

（5）会话层

**会话层**（Session Layer）是 OSI 参考模型的第5层。

会话层允许不同机器上的用户建立会话关系，主要是针对远程访问，主要任务包括会话管理、传输同步以及数据交换管理等。会话一般都是面向连接的，如当文件传输到中途时建立的连接突然断掉，是从文件的开始重传还是断点续传，这个任务由会话层来完成。

会话层协议的代表有 Net BIOS、ZIP（Apple Talk区域信息协议）等。

（6）表示层

**表示层**（Presentation Layer）是 OSI 参考模型的第6层。

表示层关心的是所传输的信息的语法和语义。表示层的主要功能是：用于处理在多个通信系统之间交换信息的表示方式，主要包括数据格式的转换、数据加密与解密、数据压缩与恢复等。

表示层协议的代表有 ASCII、ASN.1、JPEG、MPEG 等。

（7）应用层

**应用层**（Application Layer）是 OSI 参考模型的最高层。

应用层为网络用户或应用程序提供各种服务，如文件传输、电子邮件、网络管理和远程登录等。

应用层协议的代表有 Telnet、FTP、HTTP、SNMP 等。

![img](https://mmbiz.qpic.cn/mmbiz_jpg/bQicJnZn4LHTuxKwib3AibzSz7x7m55ia3yJbtDVGcia7bB7uHDIQiaHknAUZrMVS6VcKbVvIqbZlPoWO9iauicWo1LfkQ/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

**TCP/IP 分层模型**的四个协议层分别完成以下的**功能**：　　

第一层**网络接口层**　　网络接口层定义了数据从网络传输的物理细节，即比特如何被与网络介质直接交互的硬件设备接口通过电子或光学方式发送。

网络接口层包括用于协作IP数据在已有网络介质上传输的协议。实际上TCP/IP标准并不定义与ISO数据链路层和物理层相对应的功能，提供TCP/IP协议的数据结构和实际物理硬件之间的接口。　　

第二层**网际层**　　网际层对应于OSI七层参考模型的网络层。

本层包含IP协议、RIP协议(Routing Information Protocol，路由信息协议)，负责数据的包装、寻址和路由。同时还包含网间控制报文协议(Internet Control Message Protocol,ICMP)用来提供网络诊断信息。　　

第三层传输层　　传输层对应于OSI七层参考模型的传输层，它提供两种端到端的通信服务。

其中TCP协议(Transmission Control Protocol)提供可靠的数据流运输服务，UDP协议(Use Datagram Protocol)提供不可靠的用户数据报服务。　　

第四层应用层　　应用层对应于OSI七层参考模型的应用层、表示层和会话层。

因特网的应用层协议包括Finger、Whois、FTP(文件传输协议)、Gopher、HTTP(超文本传输协议)、Telent(远程终端协议)、SMTP(简单邮件传送协议)、IRC(因特网中继会话)、NNTP（网络新闻传输协议）等。

![img](https://mmbiz.qpic.cn/mmbiz_jpg/bQicJnZn4LHTuxKwib3AibzSz7x7m55ia3yJt8NxfuEAIB3QqslhFcCOwTSLU8xmCCFmia4w8hroNkHjQogVuXhmQvA/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

## No.2 协议簇

**协议簇**包括上百个各种功能的协议，TCP 和 IP 协议仅是保证数据完整传输的两个基本的重要协议。通常说 TCP/IP 是 Internet 协议族。

TCP/IP 参考模型各层对应的协议已经得到广泛应用。

![img](https://mmbiz.qpic.cn/mmbiz_png/bQicJnZn4LHTuxKwib3AibzSz7x7m55ia3yJF6pPV1bRPicHiccoE7tYexiaC0Cr1COcWBqqwATxTTNj78foKic95EVf4Q/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

### 01 数据链路层

数据链路层主要功能

① 建立、维护和释放数据链路

② 定界、同步、处理透明性问题：差错控制、顺序控制、流量控制

③ 封装和成帧（分帧）：将比特流分成离散的帧，并计算每个帧的校验和

④ 为网络层发送和接收IP数据报、发送 ARP/RARP 请求和接受 ARP/RARP 应答

主要协议

① 点对点信道

* 面向字符型：IBM BSC、ISO BM、SLIP、PPP

* 面向比特型：IBM SDLC、ANSI ADLC、ISO HDLC、X.25 LAPB

② 广播信道

* 逻辑链路控制子层：IEEE 802.2

* 介质访问控制子层：IEEE 802.3、802.4、802.5

*TCP/IP用于不同网络的协议*

a) 有线局域网：以太网、令牌环、令牌总线网、FDDI等

b) 无线局域网：IEEE802.11、802.15等

c) 点到点广域网：PPP

d) 交换广域网：X.25、帧中继、ATM等

### 02 网络层

**IP(Internet Protocol)网际协议**：

IPv4 和 IPv6 分别使用点分十进制和冒分十六进制表示一个 IP

**ARP(Address Resolution Protocol)地址解析协议**：

网络层使用 IP 地址，物理网络中使用物理地址(MAC地址)，两套地址之间的转换过程叫做**地址解析**

① 静态映射：采用地址映射表来实现IP地址和物理地址之间的映射，即在主机中利用地址映射表来记录网络上其他主机或网络设备的IP地址和物理地址对应关系

② 动态映射：在因特网上需要获得地址映射关系时，利用网络通信协议直接从其他主机上获得IP地址和物理地址的映射关系，包括地址解析协议(ARP)和反向地址解析协议(RARP)

IP地址——ARP——>MAC地址

MAC地址——RARP——>IP地址

**IP路由选择协议**：

使得在互联网中的路由器能够彼此互相通知路由变化信息的一些规则和过程的集合

* 距离矢量路由选择协议：RIPv1、RIPv2
* 链路状态路由选择协议：OSPF
* 路径向量路由选择协议：BGP

**ICMP(Internet Control Message Protocol)网际控制报文协议**：

IP 是不可靠、无连接的传输协议，尽力而为的点到点数据传输服务，不能保证数据报成功从信源到达信宿，ICMP 能够传递网络控制信息、提供差错报告，功能包括IP层差错报告、拥塞控制、路径控制以及路由器或主机信息的获取，主要用于 ping、tracert

**IGMP(Internet Group Management Protocol)网际组管理协议**：

多播路由器和主机之间进行群组关系的管理，运行与主机和多播路由器间

### 03 传输层

**UDP(User Data Protocol)用户数据协议**：

传送数据前不需先建立连接，对方收到 UDP 报文后不需确认。不提供可靠交付，在某些情况下最有效的方式

**TCP(Transmission Control Protocol)传输控制协议**：

可靠地、面向连接的传输服务，不提供广播或多播服务。增加了开销，协议数据单元首部增大，占用处理机资源

### 04 应用层

应用层支撑协议包括域名解析协议(DNS)、简单网络管理协议(SNMP)等

典型应用包括Web浏览、电子邮件、文件传输访问、远程登录等

与应用相关的协议包括超文本传输协议(HTTP)、简单邮件传输协议(SMTP)、邮局协议(POP3)、文件传输协议(FTP)、简单文件传输协议(TFTP)和远程登录(Telnet)等

## No.3 结尾

暂时不知道该讲些什么了，以后想起来了再修改吧

拖了挺久了，可能文章写的不太好，如果发现错误欢迎大家指正

图片和部分文字参考百度百科、CSDN 和其他博客，如有侵权，可联系删除
